:root{
  --bg:#0f1720;
  --panel:#0b1220;
  --text:#e6eef6;
  --accent:#7dd3fc;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Segoe UI, Roboto, Arial, sans-serif;background:var(--bg);color:var(--text)}
main{max-width:1000px;margin:24px auto;padding:16px}
h1{margin:0 0 12px 0}
.game-wrap{display:flex;gap:16px;align-items:flex-start}
.canvas-wrap{position:relative;display:inline-block}
canvas{background:#071029;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.5);display:block}
.subtitle{position:absolute;left:50%;transform:translateX(-50%);bottom:12px;padding:6px 10px;border-radius:6px;background:rgba(0,0,0,0.6);color:#fff;font-weight:600;font-size:0.95rem;pointer-events:none;opacity:0;transition:opacity 0.12s}
.subtitle.show{opacity:1}
.controls{width:300px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:8px}
.stats{font-family:monospace;margin-bottom:8px}
/* Compact HUD styles */
.compact-hud{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}
.stat-row{display:flex;align-items:center;gap:8px}
.stat-label{width:80px;font-size:0.9rem;color:#cfeff7}
.stat-bar{flex:1;height:12px;background:rgba(255,255,255,0.06);border-radius:8px;overflow:hidden}
.stat-fill{height:100%;width:0%;background:linear-gradient(90deg,#7dd3fc,#7ef0c7);transition:width 0.2s}
.stat-value{width:36px;text-align:right;font-family:monospace;font-size:0.85rem}

.toggle-small{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:4px 8px;border-radius:6px;cursor:pointer}
.toggle-small:hover{background:rgba(255,255,255,0.02)}

/* Modal for Training */
.modal{display:none;position:fixed;inset:0;z-index:2000}
.modal.show{display:block}
.modal-overlay{position:absolute;inset:0;background:rgba(2,6,23,0.6)}
.modal-dialog{position:relative;max-width:420px;margin:6vh auto;background:var(--panel);border-radius:10px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,0.6);color:var(--text)}
.modal-close{position:absolute;right:8px;top:8px;border:0;background:transparent;color:var(--text);font-size:1.1rem;cursor:pointer}
.training-modal-content h3{margin-top:0}

/* FAQ/legend FAQ button positioned under the canvas */
.canvas-wrap{position:relative}
.faq-button{position:absolute;left:8px;bottom:8px;padding:6px 8px;font-size:0.85rem;border-radius:6px}

/* Screen-reader only helper */
.sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;border:0;padding:0;margin:-1px}

/* Battle badge (temporary) */
.battle{position:relative}
.battle-badge{position:absolute;right:8px;top:6px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,0.5);color:#fff;font-weight:800;letter-spacing:0.08em;font-size:0.75rem;transform:translateY(-6px) scale(0.96);opacity:0;transition:transform 260ms ease, opacity 260ms ease, background 260ms ease}
.battle-badge.show{opacity:1;transform:translateY(0) scale(1);}
.battle-badge.victory{background:linear-gradient(90deg,#66ff9c,#3bd98a);color:#08321a}
.battle-badge.defeat{background:linear-gradient(90deg,#ff8b8b,#ff6b6b);color:#330a0a}

/* Slightly wider dialog for battle modal */
.battle-modal-content .modal-dialog, .modal-dialog .battle-modal-content{}
.modal-dialog[aria-labelledby="battle-title"]{max-width:520px}
.color-legend{margin-top:10px;font-size:0.9rem}
.color-legend h3{margin:6px 0 6px 0;font-size:0.95rem}
.legend-bar{height:12px;border-radius:6px;background:linear-gradient(90deg, hsl(0 65% 55%), hsl(100 65% 55%), hsl(200 65% 55%));margin-bottom:8px}
.legend-rows{display:flex;flex-direction:column;gap:6px;color:var(--text)}
.legend-key{display:inline-block;width:14px;height:14px;border-radius:3px;margin-right:8px;vertical-align:middle;box-shadow:0 1px 2px rgba(0,0,0,0.4)}
.legend-note{margin-top:8px;color:#9fb6c6;font-size:0.85rem}
.buttons{display:flex;gap:8px;flex-wrap:wrap}

.evo{margin-top:12px;font-size:0.9rem}
.evo h3{margin:6px 0}
.evo-bar{height:12px;background:rgba(255,255,255,0.06);border-radius:8px;overflow:hidden;margin-bottom:6px}
.evo-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent), #7ef0c7);transition:width 0.25s ease}
.evo-label{color:#cfeff7;font-size:0.85rem}
.evo.hidden{display:none}
.buttons button{flex:1;padding:8px;border-radius:6px;border:0;background:var(--accent);color:#042233;cursor:pointer;font-weight:600;transition:background 0.2s}
.buttons button:hover{background:#5fbff8}
.buttons button.btn-reset{background:#ff6b6b;color:#fff;min-width:60px;flex:0}
.buttons button.btn-reset:hover{background:#ff5252}

/* Disabled/Dead state styling for buttons */
button.disabled, button[disabled]{
  opacity: 0.45;
  filter: grayscale(60%);
  cursor: not-allowed;
}
.buttons button.btn-freeze{background:#9f7aea;color:#fff;min-width:70px;flex:0}
.buttons button.btn-freeze:hover{background:#8a67d9}
.buttons button.btn-freeze.frozen{background:#5a4a8a}

.training{margin-top:12px;font-size:0.9rem}
.training h3{margin:6px 0}
.training-stats{display:flex;flex-direction:column;gap:6px;margin-bottom:8px}
.training-stat{display:flex;justify-content:space-between;align-items:center;font-size:0.85rem}
.training-bar{height:8px;background:rgba(255,255,255,0.06);border-radius:4px;flex:1;margin:0 8px;overflow:hidden}
.training-fill{height:100%;background:linear-gradient(90deg,#ff9f43, #f8b500);transition:width 0.2s}
.training-buttons{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:8px}
.training-buttons button{flex:1;padding:6px;font-size:0.8rem;min-width:70px;background:#ff9f43;color:#1a1a1a;border:0;border-radius:4px;cursor:pointer;font-weight:600}
.training-buttons button:hover{background:#ffb347}

.battle{margin-top:12px;font-size:0.9rem;padding:8px;background:rgba(255,100,100,0.1);border-radius:6px;border:1px solid rgba(255,100,100,0.3)}
.battle h3{margin:0 0 8px 0}
.battle-info{font-size:0.85rem;margin-bottom:6px}
.battle-hps{display:flex;gap:8px;margin-bottom:8px;font-size:0.85rem}
.battle-hp-bar{flex:1;display:flex;flex-direction:column;gap:2px}
.battle-hp-fill{height:12px;background:linear-gradient(90deg,#4caf50,#8bc34a);border-radius:2px;width:100%;background-size:100% 100%}
.battle-log{background:rgba(0,0,0,0.3);border-radius:4px;padding:6px;margin-bottom:8px;font-size:0.8rem;max-height:80px;overflow-y:auto;color:#afc}
.battle-buttons{display:flex;gap:4px}
.battle-buttons button{flex:1;padding:6px;font-size:0.8rem;background:#ff6b6b;color:#fff;border:0;border-radius:4px;cursor:pointer;font-weight:600}
.battle-buttons button:hover{background:#ff5252}

/* Slide-in animation for the battle panel when it becomes active */
.battle{
  transform: translateY(6px);
  opacity: 0.98;
  transition: transform 260ms cubic-bezier(.2,.9,.2,1), opacity 220ms ease;
}
.battle.show{
  transform: translateY(0);
  opacity: 1;
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  border-color: rgba(255,100,100,0.45);
}

/* Focus outline for keyboard users */
.battle:focus{outline: 3px solid rgba(125,211,252,0.12);outline-offset:4px}

/* Victory / Defeat visual indicators */
.battle.victory{
  border-color: rgba(102,255,156,0.9);
  box-shadow: 0 10px 30px rgba(102,255,156,0.12);
  animation: battle-victory-pulse 900ms ease-in-out;
}
.battle.defeat{
  border-color: rgba(255,102,102,0.95);
  box-shadow: 0 10px 30px rgba(255,102,102,0.12);
  animation: battle-defeat-pulse 900ms ease-in-out;
}

@keyframes battle-victory-pulse{
  0%{ transform: translateY(0) scale(1); }
  50%{ transform: translateY(-4px) scale(1.02); }
  100%{ transform: translateY(0) scale(1); }
}
@keyframes battle-defeat-pulse{
  0%{ transform: translateY(0) scale(1); }
  50%{ transform: translateY(2px) scale(0.995); filter: saturate(0.9); }
  100%{ transform: translateY(0) scale(1); }
}

/* HP flash animations on result */
.hp-flash-victory{animation: hp-flash-green 900ms ease-in-out}
.hp-flash-defeat{animation: hp-flash-red 900ms ease-in-out}
@keyframes hp-flash-green{
  0%{ box-shadow:none; filter: none; }
  30%{ box-shadow:0 0 18px rgba(80,255,160,0.28); filter: saturate(1.05); }
  100%{ box-shadow:none; filter:none }
}
@keyframes hp-flash-red{
  0%{ box-shadow:none }
  30%{ box-shadow:0 0 18px rgba(255,100,100,0.28); filter: saturate(0.95); }
  100%{ box-shadow:none }
}

/* Victory banner overlay */
.victory-banner{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) scale(0.8);
  opacity:0;
  pointer-events:none;
  z-index:5000;
  background:linear-gradient(135deg, rgba(102,255,156,0.95), rgba(61,216,138,0.95));
  padding:40px 60px;
  border-radius:16px;
  box-shadow:0 20px 60px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.2);
  text-align:center;
  font-size:2.2rem;
  font-weight:900;
  color:#fff;
  letter-spacing:2px;
  text-shadow:2px 2px 4px rgba(0,0,0,0.3);
  transition:transform 400ms cubic-bezier(0.34,1.56,0.64,1), opacity 400ms ease;
}
.victory-banner.show{
  transform:translate(-50%,-50%) scale(1);
  opacity:1;
}

/* Defeat banner overlay */
.defeat-banner{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) scale(0.8);
  opacity:0;
  pointer-events:none;
  z-index:5000;
  background:linear-gradient(135deg, rgba(255,107,107,0.95), rgba(255,100,100,0.95));
  padding:40px 60px;
  border-radius:16px;
  box-shadow:0 20px 60px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.1);
  text-align:center;
  font-size:2.2rem;
  font-weight:900;
  color:#fff;
  letter-spacing:2px;
  text-shadow:2px 2px 4px rgba(0,0,0,0.4);
  transition:transform 400ms cubic-bezier(0.34,1.56,0.64,1), opacity 400ms ease;
}
.defeat-banner.show{
  transform:translate(-50%,-50%) scale(1);
  opacity:1;
}

.log{margin-top:12px;font-size:0.9rem;min-height:60px}
footer{margin-top:16px;color:#99a3af}

/* Shop and Inventory modal styles */
.shop-modal-content h3,
.inventory-modal-content h3 {
  margin-top: 0;
}

.shop-buy-btn {
  width: 100%;
  padding: 8px;
  background: linear-gradient(135deg, #4caf50, #45a049);
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
  font-size: 0.95rem;
}

.shop-buy-btn:hover:not(:disabled) {
  background: linear-gradient(135deg, #66bb6a, #5cb85c);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.shop-buy-btn:active:not(:disabled) {
  transform: translateY(0);
}

.shop-buy-btn:disabled {
  background: #999;
  cursor: not-allowed;
  opacity: 0.6;
}

@media(max-width:820px){
  .game-wrap{flex-direction:column;align-items:center}
  .controls{width:100%}
  canvas{width:100%;height:auto}
}
